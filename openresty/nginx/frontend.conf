# Recipe routes with metadata injection for rich link previews - publicly acessible
location ~ ^/recipe/ {
    root html;
    
    # Try to inject template values first for the specific recipe
    access_by_lua_file 'lua/metadata_injector.lua';
    
    # If the Lua code doesn't handle the request, serve the SPA
    try_files $uri /index.html;
}

# SPA frontend setup
location / {
    root html;
    # Let the SPA frontend handle routing
    try_files $uri /index.html;
}

